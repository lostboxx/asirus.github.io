<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <meta name="description" content="–ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä ¬´BASE 64¬ª –∏ –ò–Ω—Ñ–æ—Ä–º–∞—Ç–æ—Ä ¬´BASE 64¬ª –æ—Ç Asirus - –¢—É—Ç –º–æ–∂–Ω–æ –±–µ—Å–ø–ª–∞—Ç–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–µ —Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ/–∞—É–¥–∏–æ –≤ BASE 64 –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –µ–≥–æ –Ω–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å!">
<link rel="icon" href="/res/img/favicon.png">
  <title>–ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä –∏ –ò–Ω—Ñ–æ—Ä–º–∞—Ç–æ—Ä BASE 64</title>
  <style>
    body {
      background: #87CEEB;
      color: #000;
      font-family: sans-serif;
      margin: 0;
      padding: 10px;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      box-sizing: border-box;
    }
    section {
      width: 100%;
      max-width: 500px;
      margin-bottom: 20px;
    }
    h1 {
      margin: 10px 0 5px;
      font-size: 20px;
      text-align: center;
    }
    p.subtitle {
      font-size: 13px;
      margin-bottom: 10px;
      text-align: center;
      color: #222;
      max-width: 90%;
    }
    .uploader {
      position: relative;
      width: 80vw; max-width: 240px;
      height: 80vw; max-height: 240px;
      border: 2px dashed #555;
      display: flex; align-items: center; justify-content: center;
      cursor: pointer; background: #fff; margin-bottom: 10px;
      user-select: none; border-radius: 12px; overflow: hidden;
      margin: 0 auto;
    }
    .uploader.placeholder::before {
      content: "+";
      font-size: 48px; color: #555;
    }
    .uploader img, .uploader video, .uploader audio {
      width: 100%; height: 100%; object-fit: contain; display: block;
    }
    input[type="file"] {
      display: none;
    }
    .download-btn {
      margin-top: 10px; padding: 8px 16px;
      background: #0cf; color: #000; border: none; border-radius: 6px;
      cursor: pointer; font-size: 14px; font-weight: bold;
      display: none;
    }
    .file-info {
      font-size: 12px;
      margin-top: 5px;
      color: #444;
      text-align: center;
    }
    hr {
      width: 100%;
      max-width: 500px;
      border: 0;
      border-top: 2px solid #555;
      margin: 20px 0;
    }
    #extension-input-container {
      display: none;
      margin: 10px 0;
      text-align: center;
    }
    #extension-input {
      padding: 5px;
      border: 1px solid #555;
      border-radius: 4px;
      margin-right: 5px;
    }
    #extension-submit {
      padding: 5px 10px;
      background: #0077cc;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    .status {
      font-size: 14px;
      margin-top: 5px;
      font-weight: bold;
      text-align: center;
    }
    .reset-btn {
      margin-top: 6px;
      font-size: 14px;
      color: #0077cc;
      cursor: pointer;
      user-select: none;
      text-align: center;
    }
    h6 {
      margin: 10px 0;
      text-align: center;
      font-weight: normal;
      font-size: 12px;
    }
  </style>
</head>
<body>
  <!-- –ü–∏—Å–∞—Ç–µ–ª—å (–ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä –≤ Base64) -->
  <section id="writer-section">
    <h1>BASE-64 –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä</h1>
    <p class="subtitle">–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ, –≤–∏–¥–µ–æ –∏–ª–∏ –∞—É–¥–∏–æ –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –≤ Base64</p>  
    <div id="uploader-writer" class="uploader placeholder" tabindex="0"></div>
    <input type="file" id="file-input-writer" accept="image/*,video/*,audio/*">
    <div id="file-info-writer" class="file-info"></div>
    <button id="download-btn-writer" class="download-btn">–°–∫–∞—á–∞—Ç—å Base64</button>
    <div id="reset-btn-b64" class="reset-btn" style="display:none;">üîÑ –°–±—Ä–æ—Å</div>
    <h6>–ò—Å–ø–æ–ª—å–∑—É–π –Ω–∞—à ¬´–∏–Ω—Ñ–æ—Ä–º–∞—Ç–æ—Ä¬ª —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∞–π–ª –Ω–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å!</h6> 
  </section>

  <hr>

  <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ç–æ—Ä (–ü—Ä–æ–≤–µ—Ä–∫–∞ Base64) -->
  <section id="info-section">
    <h1>–ò–Ω—Ñ–æ—Ä–º–∞—Ç–æ—Ä BASE-64</h1>
    <p class="subtitle">–ó–∞–≥—Ä—É–∑–∏—Ç–µ .txt —Å base64-—Å–æ–¥–µ—Ä–∂–∏–º—ã–º (—Ñ–æ—Ç–æ, –∞—É–¥–∏–æ, –≤–∏–¥–µ–æ)</p>
    <div id="uploader-info" class="uploader placeholder" tabindex="0"></div>
    <input type="file" id="file-input-info" accept=".txt,application/json,image/*">
    
    <div id="extension-input-container">
      <p>–í–≤–µ–¥–∏—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞:</p>
      <input type="text" id="extension-input" placeholder="jpg, png, mp3...">
      <button id="extension-submit">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
    </div>
    
    <div id="status" class="status"></div>
    <div id="reset-btn" class="reset-btn" style="display:none;">üîÑ –°–±—Ä–æ—Å</div>
  </section>

  <script>
    // –û–±—â–∏–π —Å–ª–æ–≤–∞—Ä—å MIME —Ç–∏–ø–æ–≤
    const extensionTypes = {
      // –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
      'jpg': 'image/jpeg',
      'jpeg': 'image/jpeg',
      'png': 'image/png',
      'gif': 'image/gif',
      'bmp': 'image/bmp',
      'webp': 'image/webp',
      'svg': 'image/svg+xml',
      'ico': 'image/x-icon',
      
      // –ê—É–¥–∏–æ
      'mp3': 'audio/mpeg',
      'wav': 'audio/wav',
      'ogg': 'audio/ogg',
      'aac': 'audio/aac',
      'flac': 'audio/flac',
      'm4a': 'audio/mp4',
      
      // –í–∏–¥–µ–æ
      'mp4': 'video/mp4',
      'avi': 'video/x-msvideo',
      'mov': 'video/quicktime',
      'webm': 'video/webm',
      'mkv': 'video/x-matroska',
      'flv': 'video/x-flv',
      'wmv': 'video/x-ms-wmv',
      'm4v': 'video/mp4',
      '3gp': 'video/3gpp'
    };

    // ========== –ö–û–î –î–õ–Ø –ü–ò–°–ê–¢–ï–õ–Ø (–ö–û–ù–í–ï–†–¢–ï–†) ==========
    const uploaderWriter = document.getElementById('uploader-writer');
    const fileInputWriter = document.getElementById('file-input-writer');
    const downloadBtnWriter = document.getElementById('download-btn-writer');
    const fileInfoWriter = document.getElementById('file-info-writer');
    const resetBtnB64 = document.getElementById('reset-btn-b64');
    let lastData = '';

    uploaderWriter.addEventListener('click', () => fileInputWriter.click());

    fileInputWriter.addEventListener('change', e => {
      const file = e.target.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = () => processWrite(reader.result, file);
      reader.readAsDataURL(file);
    });

    downloadBtnWriter.addEventListener('click', () => {
      if (!lastData) return;
      
      const blob = new Blob([lastData], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'base64.txt';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    });

    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ —Å–±—Ä–æ—Å–∞ –≤ —Ä–∞–∑–¥–µ–ª–µ "–ü–∏—Å–∞—Ç–µ–ª—å"
    resetBtnB64.addEventListener('click', resetWriter);

    function processWrite(dataURL, file) {
      // –ü–æ–ª—É—á–∞–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
      const fileName = file.name.toLowerCase();
      const extension = fileName.split('.').pop();
      
      // –ü–æ–ª—É—á–∞–µ–º MIME —Ç–∏–ø –∏–∑ —Å–ª–æ–≤–∞—Ä—è
      const mimeType = extensionTypes[extension];
      const mediaType = mimeType ? mimeType.split('/')[0] : 'unknown';
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∞–π–ª–µ
      fileInfoWriter.textContent = `–¢–∏–ø: ${mediaType} | –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ: ${extension}`;

      // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ
      lastData = dataURL;

      // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –º–µ–¥–∏–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞
      uploaderWriter.innerHTML = '';
      uploaderWriter.classList.remove('placeholder');

      if (mediaType === 'image') {
        const img = new Image();
        img.onload = () => {
          uploaderWriter.appendChild(img);
          downloadBtnWriter.style.display = 'block';
          resetBtnB64.style.display = 'block'; // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É —Å–±—Ä–æ—Å–∞
        };
        img.src = dataURL;
      } else if (mediaType === 'audio') {
        const audio = document.createElement('audio');
        audio.controls = true;
        audio.onloadeddata = () => {
          uploaderWriter.appendChild(audio);
          downloadBtnWriter.style.display = 'block';
          resetBtnB64.style.display = 'block'; // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É —Å–±—Ä–æ—Å–∞
        };
        audio.onerror = () => {
          uploaderWriter.textContent = '–ê—É–¥–∏–æ —Ñ–∞–π–ª';
          downloadBtnWriter.style.display = 'block';
          resetBtnB64.style.display = 'block'; // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É —Å–±—Ä–æ—Å–∞
        };
        audio.src = dataURL;
      } else if (mediaType === 'video') {
        const video = document.createElement('video');
        video.controls = true;
        video.onloadeddata = () => {
          uploaderWriter.appendChild(video);
          downloadBtnWriter.style.display = 'block';
          resetBtnB64.style.display = 'block'; // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É —Å–±—Ä–æ—Å–∞
        };
        video.onerror = () => {
          uploaderWriter.textContent = '–í–∏–¥–µ–æ —Ñ–∞–π–ª';
          downloadBtnWriter.style.display = 'block';
          resetBtnB64.style.display = 'block'; // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É —Å–±—Ä–æ—Å–∞
        };
        video.src = dataURL;
      } else {
        // –î–ª—è –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Ç–∏–ø–æ–≤ –ø—Ä–æ—Å—Ç–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ
        uploaderWriter.textContent = '–§–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω';
        downloadBtnWriter.style.display = 'block';
        resetBtnB64.style.display = 'block'; // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É —Å–±—Ä–æ—Å–∞
      }
    }

    // –§—É–Ω–∫—Ü–∏—è —Å–±—Ä–æ—Å–∞ –¥–ª—è —Ä–∞–∑–¥–µ–ª–∞ "–ü–∏—Å–∞—Ç–µ–ª—å"
    function resetWriter() {
      uploaderWriter.innerHTML = '';
      uploaderWriter.classList.add('placeholder');
      fileInfoWriter.textContent = '';
      downloadBtnWriter.style.display = 'none';
      resetBtnB64.style.display = 'none';
      fileInputWriter.value = '';
      lastData = '';
    }

    // ========== –ö–û–î –î–õ–Ø –ò–ù–§–û–†–ú–ê–¢–û–†–ê (–ü–†–û–í–ï–†–ö–ê) ==========
    const uploaderInfo = document.getElementById('uploader-info');
    const fileInputInfo = document.getElementById('file-input-info');
    const statusDiv = document.getElementById('status');
    const resetBtn = document.getElementById('reset-btn');
    const extensionInputContainer = document.getElementById('extension-input-container');
    const extensionInput = document.getElementById('extension-input');
    const extensionSubmit = document.getElementById('extension-submit');

    let currentBase64Data = '';

    uploaderInfo.addEventListener('click', () => {
      fileInputInfo.click();
      statusDiv.textContent = '';
      resetBtn.style.display = 'none';
      extensionInputContainer.style.display = 'none';
    });

    fileInputInfo.addEventListener('change', e => {
      const file = e.target.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = () => {
        const text = reader.result.trim();
        processCheck(text);
      };
      reader.readAsText(file);
    });

    resetBtn.addEventListener('click', resetAll);
    
    extensionSubmit.addEventListener('click', () => {
      const extension = extensionInput.value.toLowerCase().trim();
      if (!extension) {
        statusDiv.textContent = '‚ùå –í–≤–µ–¥–∏—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞';
        return;
      }
      
      processWithExtension(extension);
    });

    function processCheck(data) {
      currentBase64Data = data;
      
      // –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —É–∂–µ —Å–æ–¥–µ—Ä–∂–∞—Ç data: URI —Å—Ö–µ–º—É (–ª—é–±–æ–≥–æ —Ç–∏–ø–∞)
      if (data.startsWith('data:')) {
        validateAndDisplay(data);
        return;
      }

      // –ü—Ä–æ–≤–µ—Ä–∏–º, –ø–æ—Ö–æ–∂–µ –ª–∏ —ç—Ç–æ –≤–æ–æ–±—â–µ –Ω–∞ base64
      const isMaybeB64 = /^[A-Za-z0-9+/=\s\r\n]+$/.test(data);
      if (isMaybeB64) {
        // –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–µ –¥–ª—è –≤–≤–æ–¥–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
        extensionInputContainer.style.display = 'block';
        statusDiv.textContent = '‚ö†Ô∏è –í–≤–µ–¥–∏—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏';
      } else {
        statusDiv.textContent = '‚ùó –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π txt-—Ñ–∞–π–ª —Å Base64';
        resetBtn.style.display = 'block';
      }
    }

    function processWithExtension(extension) {
      const cleanB64 = currentBase64Data.replace(/\s+/g, '');
      
      // –ü–æ–ª—É—á–∞–µ–º MIME —Ç–∏–ø –∏–∑ —Å–ª–æ–≤–∞—Ä—è
      const mimeType = extensionTypes[extension];
      
      if (mimeType) {
        const fullDataURI = `data:${mimeType};base64,${cleanB64}`;
        validateAndDisplay(fullDataURI);
      } else {
        statusDiv.textContent = `‚ùå –ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ: ${extension}`;
      }
    }

    function validateAndDisplay(dataURI) {
      // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –º–µ–¥–∏–∞
      const mediaType = dataURI.split(':')[1].split(';')[0].split('/')[0];
      
      switch(mediaType) {
        case 'image':
          displayImage(dataURI);
          break;
        case 'audio':
          displayAudio(dataURI);
          break;
        case 'video':
          displayVideo(dataURI);
          break;
        default:
          statusDiv.textContent = '‚ùå –ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ç–∏–ø –º–µ–¥–∏–∞';
          resetBtn.style.display = 'block';
      }
    }

    function displayImage(src) {
      const img = new Image();
      img.onload = () => {
        uploaderInfo.innerHTML = ''; 
        uploaderInfo.classList.remove('placeholder');
        uploaderInfo.appendChild(img);
        statusDiv.textContent = '‚úîÔ∏è –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–∞–ª–∏–¥–Ω–æ. –ò—Å–ø–æ–ª—å–∑—É–π –Ω–∞—à ¬´–ü–∏—Å–∞—Ç–µ–ª—å¬ª —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å base64 —Ñ–∞–π–ª!';
        resetBtn.style.display = 'block';
        extensionInputContainer.style.display = 'none';
      };
      img.onerror = () => {
        statusDiv.textContent = '‚ùå –ü–æ–≤—Ä–µ–∂–¥—ë–Ω–Ω—ã–π Base64 (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ)';
        resetBtn.style.display = 'block';
        extensionInputContainer.style.display = 'none';
      };
      img.src = src;
    }

    function displayAudio(src) {
      const audio = document.createElement('audio');
      audio.controls = true;
      
      audio.onloadeddata = () => {
        uploaderInfo.innerHTML = ''; 
        uploaderInfo.classList.remove('placeholder');
        uploaderInfo.appendChild(audio);
        statusDiv.textContent = '‚úîÔ∏è –ê—É–¥–∏–æ –≤–∞–ª–∏–¥–Ω–æ. –ò—Å–ø–æ–ª—å–∑—É–π –Ω–∞—à ¬´–ü–∏—Å–∞—Ç–µ–ª—å¬ª —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å base64 —Ñ–∞–π–ª!';
        resetBtn.style.display = 'block';
        extensionInputContainer.style.display = 'none';
      };
      
      audio.onerror = () => {
        statusDiv.textContent = '‚ùå –ü–æ–≤—Ä–µ–∂–¥—ë–Ω–Ω—ã–π Base64 (–∞—É–¥–∏–æ)';
        resetBtn.style.display = 'block';
        extensionInputContainer.style.display = 'none';
      };
      
      audio.src = src;
    }

    function displayVideo(src) {
      const video = document.createElement('video');
      video.controls = true;
      
      video.onloadeddata = () => {
        uploaderInfo.innerHTML = ''; 
        uploaderInfo.classList.remove('placeholder');
        uploaderInfo.appendChild(video);
        statusDiv.textContent = '‚úîÔ∏è –í–∏–¥–µ–æ –≤–∞–ª–∏–¥–Ω–æ. –ò—Å–ø–æ–ª—å–∑—É–π –Ω–∞—à ¬´–ü–∏—Å–∞—Ç–µ–ª—å¬ª —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å base64 —Ñ–∞–π–ª!';
        resetBtn.style.display = 'block';
        extensionInputContainer.style.display = 'none';
      };
      
      video.onerror = () => {
        statusDiv.textContent = '‚ùå –ü–æ–≤—Ä–µ–∂–¥—ë–Ω–Ω—ã–π Base64 (–≤–∏–¥–µ–æ)';
        resetBtn.style.display = 'block';
        extensionInputContainer.style.display = 'none';
      };
      
      video.src = src;
    }

    function resetAll() {
      uploaderInfo.innerHTML = '';
      uploaderInfo.classList.add('placeholder');
      statusDiv.textContent = '';
      resetBtn.style.display = 'none';
      extensionInputContainer.style.display = 'none';
      extensionInput.value = '';
      currentBase64Data = '';
      fileInputInfo.value = '';
    }
  </script>
</body>
</html>